#Test for memory management


_import:"utilities_lib"


Employee~{
        name~String
        age~int
}

;~{
        str1~DynString.{write:"Hello, World!"}
        str2~DynString.{write:"Chunk of some data!"}
        print.line:str1
        print.line:str2
        
        str1.write:" Yes, we meet again!"
        str2.write:" Bigger chunk of some data!"
        print.line:str1
        print.line:str2
        
        str1.{destroy write:"Test for finding open chunks."}
        
        db~MasterDynList:Employee.{emplace.{
                $:@{name:"Spuds Magabbener" age:34} ;
                $:@{name:"Boris Boringen" age:52} ;
        }}
        
        db.each:@{print.{s:name s:", " d:age endl}}
        
        entry~@HeapHandlerPageTableEntry
        entry:@heapHandlerPageTableBuffer
        
        buffPtr~@BoxedInt:entry.arena.data
        for.{end:400 do:@{
                print.{d:{buffPtr.el % 256} s:" "}
                buffPtr:{buffPtr+1}
        } ; }
        
        print.endl
        
        for.{end:200 do:@{str1.write:" Filler!"} ; }
        
        table~MasterList:HeapHandlerPageTableEntry
        table.setBuffer:@heapHandlerPageTableBuffer
        entry:table.get:1
        buffPtr:entry.arena.data
        for.{end:400 do:@{
                print.{d:{buffPtr.el % 256} s:" "}
                buffPtr:{buffPtr+1}
        } ; }
        
        print.endl
}

