_import:"utilities_lib"

npair~{a~int b~int}


b0~bytes.48

mbuf~bytes.80

npairList~{
	b~bytes
	membBuffer~int
	membBufferN~int
	set_buffer~{
		in~int
		;~{
			b:in
			b.count:0
		}
	}
	set_membBuffer~{
		buf~int
		;~{
			membBuffer:buf
			membBufferN:0
		}
	}
	set~{
		at~int
		char~int
		;~{
			it~@iter:{b+{at*8}}
			it.el:char
		}
	}
	add~{
		in~int
		;~{
			set.{at:b.count char:in ;}
			b.count:{b.count + 1}
		}
	}
	emplace~{
		in~npair.;
		;~{
			ptr~@iter:{membBuffer+membBufferN}
			ptr.{in}
			membBufferN:{membBufferN+16}
			add:ptr
		}
	}
}

npList~npairList.{
	set_membBuffer:@mbuf
	set_buffer:@b0
	emplace.{
		$:@{a:1 b:0} ;
		$:@{a:2 b:5} ;
		$:@{a:0 b:5} ;
		$:@{a:2 b:7} ;
		$:@{a:4 b:1} ;
	}
}

l~list:npair
l:npList

l.each:@{print.d:{a+b}}

getmsg~{
	write~@writenf
	;~{
		write.{c:67 c:76 c:79 c:83 c:69}
	}
	
}


print.{
	hello~bytes.40
	msg~str
	msg.set_buffer:@hello
	msg.write.{getmsg:@$}
	getmsg:@$
	msg.setchar.{char:70 at:1 ; at:2 ; at:3 ; at:4 ;}
	s:msg
	d:1749 c:102 d:0 c:90 endl
}

factorial~{
	in~int
	;~{
		{in < 2} ? 1 ^ {in * factorial:{in-1}}
	}
}

print.{d:factorial:7 endl}

color~{
	~enum
	red~{~op op_val:0}
	green~{~op op_val:1}
	orange~{~op op_val:2}
	yellow~{~op op_val:3}
	blue~{~op op_val:4}
}

color_a~color
color_a.blue.set
print.{d:color_a.blue.is endl d:color_a.orange.is endl}

write_color~{
	write~@writenf
	colrw~color
	;~{
		write.{
			colrw.{
				red.is ? {s:"RED"}
				^ green.is ? {s:"GREEN"}
				^ orange.is ? {s:"ORANGE"}
				^ yellow.is ? {s:"YELLOW"}
				^ blue.is ? {s:"BLUE"}
			}
			endl
		}
	}
}


print.{write_color.{write:@$.2 colrw:color_a ; color_a.orange.set colrw:color_a ;}}

n~int:4
l.each:@{b:n n:{n-1}}
l.each:@{print.d:{a+b}}
print.endl

